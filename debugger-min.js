document.write('<html><head><title>Disruptive Advertising - Adobe DTM Debugger</title><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css"><style type="text/css">table tbody td,table thead th{padding-right:20px}body{margin:0}*{font-family:Arial,Helvetica,sans-serif}table{border:0;margin:10px 0}table thead th{text-align:left}table.info{margin:10px 0 0}table.info td{font-size:12px;color:#adadad}h1{margin-left:10px}#dtm-content{padding:10px}#main{background:#252525;width:100%;height:75px}#notifications,code.language-js{white-space:-moz-pre-wrap!important;word-wrap:break-word;word-break:break-all}#data-elements .de-type,span[data-de]{text-decoration:underline}span[data-de]:hover{cursor:pointer}table td{vertical-align:top}#column1,#column2{height:100%;overflow-y:scroll}tr[data-fired=yes] td.fired{color:green} #data-elements .de-type {cursor: pointer;} #rules td.rule {text-decoration: underline; cursor: pointer;}</style><script src="https://code.jquery.com/jquery-1.12.4.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script><script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script><script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script><script src="https://cdn.rawgit.com/beautify-web/js-beautify/master/js/lib/beautify.js"></script></head><body><div id="main"><a href="http://www.disruptiveadvertising.com" target="_blank" style="float:left; margin-left: 15px; margin-top: 12px; padding: 0;">Disruptive Advertising</a><h1 style="float:right; margin: 0 20px 0 0; height:75px; line-height: 75px; padding: 0; color:#fff;">DTM Debugger</h1></div><div style="clear:both;"></div><div id="dtm-content"><div id="dtm-info"></div><hr><div style="color: #adadad">Report any bugs or issues <a href="mailto:technology@disruptiveadvertising.com?subject=DTM%20Debugger%20Issue&body=Website:%20'+window.opener.location.href+'%0D%0ADetails:%0D%0A">to Disruptive Advertising</a></div><div style="color: #adadad">Report issues <a href="https://github.com/brandonJY/Disruptive-Advertising-Adobe-DTM-Debugger/issues">to Brandon</a></div><script type="text/javascript">_dtmDebug.init();</script></div><div class="modal fade" id="modal"><div class="modal-dialog"><div class="modal-content" style="overflow:auto"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title"></h4></div><div class="modal-body"><p></p></div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Close</button></div></div></div></div></body></html>'),window._dtmDebug={rules:[{id:"pageLoadRules",name:"Page Load",fired:function(t){var e="no";return _satellite.each(_satellite.Logger.getHistory(),function(d){var i=_dtmDebug.escapeRegEx(t.name),a=new RegExp('Rule "'+i+'" fired',"i");d[1].match(a)&&(e="yes")}),e},extra:function(t){return t.event}},{id:"rules",name:"Event Based",fired:function(t){var e="no",d=_dtmDebug.escapeRegEx(t.name);return _satellite.each(_satellite.Logger.getHistory(),function(t){var i=new RegExp('Rule "'+d+'" fired',"i");t[1].match(i)&&(e="yes")}),e},extra:function(t){return t.event}},{id:"directCallRules",name:"Direct Call",fired:function(t){var e="no";return _satellite.each(_satellite.Logger.getHistory(),function(d){var i=new RegExp('Direct call Rule "'+t.name+'" fired',"i");d[1].match(i)&&(e="yes")}),e}}],saved:{showFired:!1},escapeRegEx:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},ruleFired:function(t,e){var d,i="no",a=window.opener._satellite,s=_dtmDebug.escapeRegEx(t.name);return"pageLoadRules"==e?d=new RegExp('Rule "'+s+'" fired',"i"):"rules"==e?d=new RegExp('Rule "'+s+'" fired',"i"):"directCallRules"==e&&(d=new RegExp('Direct call Rule "'+s+'" fired',"i")),"undefined"!=typeof a?a.each(a.Logger.getHistory(),function(t){a.isString(t[1])&&t[1].match(d)&&(i="yes")}):i="--",i},firedText:function(t){return"yes"==t&&(t='<span class="label label-success">yes</span>'),t},pageEvents:{pagebottom:"Page Bottom",pagetop:"Page Top",submit:"Form Submit"},getNotifications:function(){var t=[],e=window.opener._satellite,d=$("#custom-reverse-order").is(":checked"),i=$("#custom-notifications").is(":checked");"undefined"!=typeof e&&e.each(e.Logger.messages,function(a){if(e.isString(a[1]))if(a[1].match(/^Rule.*fired\.$|^Direct call Rule|^Condition.*for rule|^Visitor ID|^Test & Target|^GAU:|^GA Universal|^detected|^Adobe Analytics|^Cannot read stored setting from localStorage|You may be using the async installation of Satellite|^Failed to trigger|^tracking a tweet button|^tracking a facebook|added.*elements\.$|^GA:|writeHTML|: Initializing at|^Cannot load sync the|^Condition function/)){var s='<p class="dtm'+(1==i?" hidden":"")+'">'+a[1]+"</p>";d?t.unshift(s):t.push(s)}else{var s='<p class="custom">'+a[1]+"</p>";d?t.unshift(s):t.push(s)}}),$("#notifications").html(t.join(""))},init:function(){if(_dtmDebug.saved.url||(_dtmDebug.saved.url=window.opener.location.href),window._satellite=window.opener._satellite,"undefined"!=typeof _satellite&&"undefined"!=typeof _satellite.buildDate){var t=[];staging=_satellite.settings.isStaging,env=staging?"Staging":"Production",opp=staging?"Production":"Staging",rules=_dtmDebug.rules,_dtmDebug.hasLoaded=!0,_dtmDebug._loading=!1,_dtmDebug.saved.url=window.opener.location.href,t.push('<table class="info">'+this.getSettings(_satellite,!0)+"</table>"),t.push('<div class="clearfix"></div>'),t.push('<div class="col-xs-6" id="column1"><h1>Rules</h1>'),t.push('<div><input type="checkbox" id="show-fired"'+(1==_dtmDebug.saved.showFired?' checked="checked"':"")+'> <label for="show-fired">Only show fired rules</label></div>'),t.push('<table id="rules" class="table table-striped"><thead><tr><th>Rule Name</th><th>Rule Type</th><th>Fired?</th><th>Other Info</th></tr></thead><tbody>'),_satellite.each(rules,function(e){var d=_satellite.configurationSettings[e.id];if(_satellite.isArray(d))_satellite.each(_satellite.configurationSettings[e.id],function(d){var i=_dtmDebug.ruleFired(d,e.id);t.push('<tr data-rule="'+d.name+'" data-type="'+e.id+'" data-fired="'+i+'"'+(1==_dtmDebug.saved.showFired&&"no"==i?' class="hidden"':"")+'><td class="rule">'+d.name+"</td><td>"+e.name+'</td><td class="fired">'+_dtmDebug.firedText(i)+"</td><td>"+(e.extra?e.extra(d):"")+"</tr>")});else if(_satellite.isObject(d))for(var i in d){var a=d[i],s=_dtmDebug.ruleFired(a,e.id);t.push('<tr data-rule="'+i+'" data-type="'+e.id+'" data-fired="'+s+'"'+(1==_dtmDebug.saved.showFired&&"no"==s?' class="hidden"':"")+'><td class="rule">'+i+"</td><td>"+e.name+'</td><td class="fired">'+_dtmDebug.firedText(s)+"</td><td>"+(e.extra?e.extra(a):"")+"</tr>")}}),t.push("</tbody></table></div>"),t.push('<div class="col-xs-6" id="column2">'),t.push("<h1>Data Elements</h1>"),t.push('<table id="data-elements" class="table table-striped"><thead><tr><th>Name</th><th>Type</th><th>Value</th></tr></thead><tbody>');for(var e in _satellite.dataElements){var d=_satellite.dataElements[e],i="",a="";"undefined"!=typeof d.customJS&&(i="Custom JS",a="customJS"),"undefined"!=typeof d.selector&&(i="CSS Selector",a="selector"),"undefined"!=typeof d.jsVariable&&(i="JS Variable",a="jsVariable"),"undefined"!=typeof d.cookie&&(i="Cookie",a="cookie"),"undefined"!=typeof d.queryParam&&(i="Query Parameter",a="queryParam"),t.push('<tr data-dename="'+e+'" data-type="'+a+'"><td>'+e+'</td><td class="de-type" data-type="'+a+'">'+i+'</td><td class="de-value">'+_dtmDebug.getDataElementValue(e)+"</td></tr>")}t.push("</tbody></table>"),t.push('<h1>DTM Notifications</h1><div><label><input type="checkbox" id="custom-notifications"'+(1==_dtmDebug.saved.onlyCustom?' checked="checked"':"")+'> Only show custom notifications</label> <label><input type="checkbox" id="custom-reverse-order"'+(1==_dtmDebug.saved.reverse?' checked="checked"':"")+'> Show newest notifications on top</label></div><div class="panel panel-default"><div class="panel-body" id="notifications">'),t.push("</div></div>"),t.push("<h1>Configuration</h1>"),t.push('<table class="table table-striped"><tr><td><strong>Environment:</strong></td><td>'+(1==_satellite.settings.isStaging?"Staging":"Production")+"</td></tr>"),t.push("<tr><td><strong>Installed Tools:</strong></td><td>");var s={tnt:"Test & Target",sc:"Adobe Analytics",visitor_id:"Visitor ID",ga_universal:"Google Analytics Universal",adlens:"Adobe Adlens",am:"Adobe Audience Manager",ga:"Google Analytics Classic"};for(var r in _satellite.tools){var n=_satellite.tools[r];n&&"default"!=r&&t.push('<p data-toolid="'+r+'">'+s[n.settings.engine]+"</p>")}t.push("</td></tr>"),t.push("</table>"),jQuery("#dtm-info").html(t.join("")),jQuery("#custom-reverse-order").on("click",function(){_dtmDebug.saved.reverse=$(this).is(":checked"),_dtmDebug.getNotifications()}),jQuery("#rules tbody .rule").on("click",function(){var t=window.opener._satellite,e=$("#modal"),d=$(this).parents("tr").attr("data-rule"),i=$(this).parents("tr").attr("data-type"),a=[],r=!1;t.each(t[i],function(i){if(i.name==d){e.find(".modal-title").html('Definition for rule "<b>'+d+'</b>"');var n=_dtmDebug.pageEvents[i.event]||i.event;n&&a.push("<tr><td><b>Triggers At</b></td><td>"+n+"</td></tr>"),i.selector&&a.push("<tr><td><b>CSS Selector</b></td><td>"+i.selector+"</td></tr>"),i.scope&&a.push("<tr><td><b>Condition</b></td><td>"+JSON.stringify(i.scope)+"</td></tr>"),i.conditions&&a.push('<tr><td><b>Condition</b></td><td><pre class="prettyprint"><code class="language-js">'+js_beautify(i.conditions.toString())+"</code></pre></td></tr>"),i.trigger&&t.each(i.trigger,function(e){if(e.engine){if(r||"sc"!=e.engine||(r=!0,a.push('<tr><td colspan="2"><b>'+s[e.engine]+"</b></td></tr>")),"sc"==e.engine&&("setVars"==e.command&&t.each(e.arguments,function(t){for(var e in t)a.push('<tr><td style="padding-left: 20px;">'+e+"</td><td>"+t[e]+"</td></tr>")}),"addEvent"==e.command&&a.push('<tr><td style="padding-left: 20px;">events</td><td>'+e.arguments.join(",")),"customSetup"==e.command&&a.push('<tr><td style="padding-left: 20px;">Custom Code</td><td><pre class="prettyprint"><code class="language-js">'+js_beautify(e.arguments[0].toString())+"</code></pre></td></tr>"),"trackLink"==e.command)){var d={o:"Custom Link",d:"File Download",e:"Exit Link"};if(a.push('<tr><td style="padding-left: 20px;">Hit Type</td><td>'+d[e.arguments[0].type]+"</td></tr>"),a.push('<tr><td style="padding-left: 20px;">Link Name</td><td>'+e.arguments[0].linkName+"</td></tr>"),t.isObject(e.arguments[0].setVars))for(var i in e.arguments[0].setVars)a.push('<tr><td style="padding-left: 20px;">'+i+"</td><td>"+e.arguments[0].setVars[i]+"</td></tr>");e.arguments[0].addEvent&&a.push('<tr><td style="padding-left: 20px;">events</td><td>'+e.arguments[0].addEvent.join(",")),e.arguments[0].customSetup&&a.push('<tr><td style="padding-left: 20px;">Custom Code</td><td><pre class="prettyprint"><code class="language-js">'+e.arguments[0].customSetup.toString()+"</code></pre></td></tr>")}}else e.command&&(a.push('<tr><td colspan="2"><b>'+e.command+"</b></td></tr>"),e.arguments&&t.each(e.arguments,function(e){for(var d in e)"scripts"==d?(a.push('<tr><td style="padding-left: 20px;">'+d+"</td>"),t.each(e[d],function(e){a.push('<td><a href="http://assets.adobedtm.com/'+t.settings.scriptDir+e.src+'" target="_blank">'+JSON.stringify(e.src)+"</a ></td ></tr >")})):a.push('<tr><td style="padding-left: 20px;">'+d+"</td><td>"+e[d]+"</td></tr>")}))}),console.log(i)}}),e.find(".modal-body p").html('<table class="table">'+a.join("")+"</table>"),PR.prettyPrint(),$("#modal").modal("show")}),jQuery("#data-elements .de-type").on("click",function(){var t=window.opener._satellite,e=$("#modal"),d=[],i=$(this).parents("tr").attr("data-dename"),a=t.dataElements[i],s=$(this).attr("data-type");e.find(".modal-title").html('Definition for data element "<b>'+i+'"</b>'),"customJS"==s&&(d.push("<tr><td><b>Type</b></td><td>Custom JS</td></tr>"),d.push('<tr><td><b>Definition</b></td><td><pre class="prettyprint"><code class="language-js">'+js_beautify(a.customJS.toString())+"</code></pre></td></tr>")),"selector"==s&&(d.push("<tr><td><b>Type</b></td><td>CSS Selector</td></tr>"),d.push("<tr><td><b>Definition</b></td><td>"+a.selector+"</td></tr>"),d.push("<tr><td><b>Element Property</b></td><td>"+a.property+"</td></tr>")),"queryParam"==s&&(d.push("<tr><td><b>Type</b></td><td>Query Parameter</td></tr>"),d.push("<tr><td><b>Definition</b></td><td>"+a.queryParam+"</td></tr>"),d.push("<tr><td><b>Case Sensitive?</b></td><td>"+(a.ignoreCase?"Yes":"No")+"</td></tr>")),"jsVariable"==s&&(d.push("<tr><td><b>Type</b></td><td>JavaScript Variable</td></tr>"),d.push("<tr><td><b>Definition</b></td><td>"+a.jsVariable+"</td></tr>")),"cookie"==s&&(d.push("<tr><td><b>Type</b></td><td>Cookie</td></tr>"),d.push("<tr><td><b>Definition</b></td><td>"+a.cookie+"</td></tr>")),a["default"]&&d.push("<tr><td><b>Default Value</b></td><td>"+a["default"]+"</td></tr>"),d.push("<tr><td><b>Force Lowercase?</b></td><td>"+(a.forceLowerCase?"Yes":"No")+"</td></tr>"),a.storeLength&&d.push("<tr><td><b>Store Length</b></td><td>"+a.storeLength+"</td></tr>"),e.find(".modal-body p").html('<table class="table">'+d.join("")+"</table>"),PR.prettyPrint(),$("#modal").modal("show")})}else 1==_dtmDebug.hasLoaded?(jQuery("#dtm-info").html('<div class="text-center"><i class="fa fa-spinner fa-pulse"></i> Waiting for new page to load...</div>'),_dtmDebug._loading=!0):jQuery("#dtm-info").html('<div class="text-center"><h1>DTM is not installed on this page!</h1><br><img src="//www.disruptiveadvertising.com/wp-content/uploads/2015/09/run-dtm.jpg"></div>');$("#show-fired").on("click",function(){_dtmDebug.saved.showFired=$(this).is(":checked"),$(this).is(":checked")?$('table#rules tbody tr[data-fired="no"]').addClass("hidden"):$("table#rules tbody tr").removeClass("hidden")}),$("#custom-notifications").on("click",function(){_dtmDebug.saved.onlyCustom=$(this).is(":checked"),$(this).is(":checked")?$("#notifications p.dtm").addClass("hidden"):$("#notifications p").removeClass("hidden")}),_dtmDebug.getNotifications(),setTimeout(function(){_dtmDebug.refresh()},1500)},getDataElementValue:function(t){try{return window.opener._satellite.getDataElement.call(window.opener._satellite,t)||window.opener._satellite.dataElementSafe.pageviewCache[t]||""}catch(e){return""}},getSettings:function(t,e){var d=t.settings.isStaging,i=d?"Staging":"Production",a=d?"Production":"Staging",s=' <button class="btn btn-default btn-xs" type="button" onclick="_dtmDebug.toggleEnvironment();">Load '+a+"</button>",r=[];return t.cssQuery('script[src*="'+t.settings.libraryName+'"]',function(t){1==t.length&&t[0].src.match(/-staging/)&&(s="")}),r.push("<tr><td>Current Environment:</td><td>"+i+s+"</td></tr>"),r.push("<tr><td>Current URL:</td><td>"+window.opener.location.href+"</td></tr>"),r.push("<tr><td>Web Property ID:</td><td>"+t.settings.libraryName+"</td></tr>"),1==i?r.push("<tr><td>Build Date:</td><td>"+t.buildDate+"</td></tr>"):r.push("<tr><td>Publish Date:</td><td>"+t.publishDate+"</td></tr>"),e===!0?r.join(""):void $("table.info").html(r.join(""))},refresh:function(){var t=window.opener._satellite;"undefined"!=typeof t?(_dtmDebug.saved.url==window.opener.location.href||_dtmDebug._loading||(_dtmDebug._loading=!0),1==_dtmDebug._loading?_dtmDebug.init():(t.each(_dtmDebug.rules,function(e){t.each(t.configurationSettings[e.id],function(t){var d=_dtmDebug.ruleFired(t,e.id),i=$('#rules tr[data-rule="'+t.name+'"]');d!=i.attr("data-fired")&&(i.attr("data-fired",d),i.find("td.fired").html(_dtmDebug.firedText(d)),i.css("background-color","#ddddff"),setTimeout(function(){i.css("background-color","transparent"),i.effect("highlight",{color:"#ddddff"},3e3)},1500),$("#show-fired").is(":checked")&&("yes"==d&&i.hasClass("hidden")?i.removeClass("hidden"):"no"!=d||i.hasClass("hidden")||i.addClass("hidden")))})}),_dtmDebug.getDataElements(t),_dtmDebug.getNotifications(),_dtmDebug.getSettings(t))):_dtmDebug.init(),setTimeout(function(){_dtmDebug.refresh()},1e3)},getDataElements:function(t){for(var e in t.dataElements){var d=$("#data-elements").find('tr[data-dename="'+e+'"]');if(d.size()>0){var i=_dtmDebug.getDataElementValue(e),a=d.find(".de-value").text();i!=a&&d.find(".de-value").text(i)}}},toggleEnvironment:function(){var t=window.opener._satellite;t&&(1==t.settings.isStaging?window.opener.localStorage.removeItem("sdsat_stagingLibrary"):window.opener.localStorage.setItem("sdsat_stagingLibrary",!0),window.opener.location.reload())}};